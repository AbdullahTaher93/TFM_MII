Preheat oven to 350 degrees F (175 degrees C). Sift together the flour, sugar, cocoa powder, baking soda, and salt into a bowl. Combine the margarine and cola in a saucepan over medium heat; bring to a boil. Stir in the flour mixture; then add the buttermilk, eggs, and marshmallows; pour the cola mixture into a 9x13 inch baking dish. Bake in preheated oven until a toothpick inserted into the center of the cake comes out clean. While the cake is baking, make a glaze by combining the butter, cola, and cocoa powder in a saucepan; bring to a boil. Place the sugar in a bowl. Pour the cola mixture over the sugar and whisk together. Stir in the pecans and vanilla. Pour the glaze over the cake while the cake is still hot.
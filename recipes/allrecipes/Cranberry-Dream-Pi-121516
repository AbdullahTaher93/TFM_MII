In a saucepan, combine sugar, cornstarch and water until smooth. Add cranberries. bring to a boil; boil and stir for 2 minutes. Reduce heat; cook until berries pop, about 5 minutes. Set aside. In a mixing bowl, beat cream cheese, confectioners' sugar and vanilla until fluffy. Fold in whipped cream. Spread evenly into pie shell. Top with the cranberry mixture. Chill for at least 4 hours. Store in the refrigerator.
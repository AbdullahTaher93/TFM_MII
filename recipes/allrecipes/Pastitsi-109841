Melt 1 tablespoon of butter in a large skillet over medium-high heat. Stir in onion and cook until it begins to soften, about 3 minutes. Stir in the ground beef, and cook until crumbly and no longer pink. Pour in the water and tomato paste. Season with salt, pepper, allspice, nutmeg, and cinnamon; cover, and simmer for 5 minutes. Remove from heat, adjust salt to taste, then refrigerate until cold. Once cold, remove any congealed fat, and thoroughly mix with 2 beaten eggs, and set aside. Preheat oven to 400 degrees F (200 degrees C). Bring a large pot of lightly salted water to a boil. Add macaroni and cook for 8 to 10 minutes or until al dente; drain, and rinse under cold water to cool. Mix the macaroni in 2 beaten eggs until well coated. Evenly spread half of the macaroni mixture into a 11x14x2 inch baking pan, sprinkle with 1/2 cup of the grated parmesan cheese, and drizzle with 1/2 cup of melted butter. Spread the meat mixture overtop, then finish with the remaining macaroni. Sprinkle the macaroni with another 1/2 cup of Parmesan cheese, and drizzle with 1/2 cup of melted butter. Whisk together 4 beaten eggs with the half-and-half, 1 cup of Parmesan cheese, flour, and salt; whisk until well blended. Pour the cream mixture evenly over top of the pastitsio, and sprinkle with nutmeg. Cover the pan with foil, and bake in the preheated oven for 15 minutes. Remove the foil, and bake until the top has turned golden brown, about 30 minutes. Remove from oven, and allow to stand for 15 minutes before serving.
Put oven rack in middle position and preheat oven to 400 degrees F. Heat butter in a 10-inch heavy skillet over moderate heat until foam subsides, then cook flour, stirring, until golden brown, 3 to 4 minutes. Transfer to a small bowl. Puree onion, garlic, peppers, sugar, vinegar, and 1/2 teaspoon salt in a blender until smooth, adding 1 to 2 tablespoons water if needed to facilitate pureeing. Heat 2 tablespoons oil in a large nonstick skillet over moderate heat until hot but not smoking, then cook puree, stirring, until thickened, 3 to 4 minutes. (Don't worry if mixture turns blue-green; this sometimes results from the interaction of vinegar and immature garlic.) Reserve 5 tablespoons puree in a small bowl (for coating lamb) and transfer remainder to another small bowl (to be served on the side with lamb). Sprinkle lamb with remaining tablespoon salt. Heat remaining tablespoon oil in cleaned 10-inch skillet over moderately high heat until hot but not smoking, then brown lamb 1 rack at a time, turning over once, about 4 minutes per rack. Transfer racks to a large roasting pan, arranging with bones curving downward. Spread 1 1/2 tablespoons malagueta puree over meaty part of each rack of lamb, excluding ends. Stir parsley into farofa mixture, then pat mixture onto lamb (over puree) to coat, pressing gently to adhere. Roast lamb until thermometer inserted diagonally 2 inches into center (do not touch bone) registers 125 degrees F (for medium-rare), 20 to 25 minutes. Transfer to a cutting board and let racks stand 15 minutes (internal temperature will rise to about 130 degrees F). Cut each rack into chops and serve remaining puree on the side.
In a saucepan, saute onion and celery in butter until tender. Add broth, potatoes, sugar, salt, rosemary, thyme and pepper; bring to a boil. Reduce heat; cover and simmer for 15-20 minutes or until potatoes are tender. Combine flour and 1/2 cup milk until smooth; gradually stir into soup. Bring to a boil; cook and stir for 2 minutes. Stir in ham, peas and remaining milk; heat through.
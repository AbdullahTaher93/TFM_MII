Toss onions and garlic with oil, then cook in a covered pot over medium heat, stirring, until onions are tender, about 10 minutes. Add spinach and broth. Bring to a boil. Cook, tossing often, until spinach is tender, 1 to 2 minutes. Add shrimp, roasted peppers, and black pepper. Cook, tossing often, until shrimp are pink and cooked through, 3 to 4 minutes. Toss sauce with hot spaghetti and serve.
Soak pinto beans overnight with plenty of water to cover. Drain, remove to a large cooking pot, and cover with fresh water. Add the bacon, red chile flakes, and garlic. Bring to a boil, then reduce heat and simmer, covered, for about 3 hours. Melt butter in a large skillet over medium-high heat. Saute onion in butter until tender. Add the tomatoes, parsley, cumin, marjoram, and salt. Simmer over low heat for about 45 minutes to blend the flavors. When beans are tender, drain off any remaining water. Pour in the tomato mixture, and simmer for an additional 20 minutes, stirring occasionally. Serve hot.
In a skillet, saute the onion, green pepper and garlic in butter until crisp-tender. Stir in the water, ham, tomato sauce, vinegar and pepper. Bring to a boil. Reduce heat; cover and simmer for 3 minutes. Add the rice; cover and cook for 5 minutes. Add the shrimp; cook 3-5 minutes longer or until shrimp turn pink and rice is cooked.
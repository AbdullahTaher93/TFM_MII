In a large skillet, saute the mushrooms and onion in oil until tender. Stir in the flour, Italian seasoning, bouillon, salt and pepper until smooth. Gradually add the milk, stirring constantly. Bring to a boil; cook and stir for 2 minutes or until thickened. Stir in the spaghetti, ham and peas; heat through. Sprinkle with the Parmesan cheese if desired.
Bring a large pot of lightly salted water to a boil. Cook bow-tie pasta at a boil, stirring occasionally, until cooked through yet firm to the bite, about 12 minutes; drain. Heat a skillet over medium heat; add butter and olive oil. Cook and stir garlic in the hot butter-oil until fragrant, about 1 minute. Add mushrooms and onion; cook and stir until tender, about 5 minutes. Mix shrimp, diced tomatoes, pesto, wine, and lemon juice into mushroom-onion mixture; simmer for 10 minutes. Remove skillet from heat; add half-and-half, Parmesan cheese, parsley, red pepper flakes, black pepper, and salt and mix until sauce is well combined. Place pasta in a serving bowl. Spoon sauce over pasta and top with extra Parmesan cheese.
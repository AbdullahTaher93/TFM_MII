In a large pot, cook the bacon until crisp. Drain the bacon on paper towels and crumble when cooled. Add the butter and onions to the pot. Cook over moderately low heat, stirring occasionally, until the onions are translucent, about 5 minutes. Add the water, clam juice, potatoes, celery, red-pepper flakes, and salt and bring to a boil. Reduce the heat and simmer until the potatoes are tender, about 20 minutes. Return the bacon to the pot. Add the corn, milk, and cream and simmer for 10 minutes. Stir in the cod and pepper. Bring back to a simmer and cook until just done, about 3 minutes longer.
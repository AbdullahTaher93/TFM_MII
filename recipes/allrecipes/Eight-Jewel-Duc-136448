Wash and dry duck inside and out. If using frozen chestnuts, bring a small saucepan of water to a boil, add the chestnuts, reduce heat to medium, and gently boil until tender, about 25 minutes. Drain, discarding the liquid, and set aside. (Chestnuts purchased in a jar require no preparation.) Break chestnuts in half. Combine rice and 1 1/2 cups water in a bowl; soak 30 minutes. Drain and set aside. Place shiitake and tree-ear mushrooms in a small bowl and cover with 2 cups very hot water. Let soak until softened, about 20 minutes. Drain, remove and discard stems from shiitake mushrooms, and cut mushrooms into 1/4 -inch dice. Slice 1 scallion thinly and combine it in a medium bowl with chestnuts, rice, mushrooms, ham, bamboo shoots, soybeans, lotus seeds, 1 tablespoon rice wine, 2 tablespoons soy sauce, the fish sauce, sugar, salt, and pepper. Loosely stuff the duck cavity with rice mixture and sew it closed with a needle and thread. Tuck the wing tips under the body. Line the wok with the whole scallions and set duck on top of scallions, breast side up. Add 2 cups water to the wok. Pour over the duck the remaining soy sauce, dark Chinese soy sauce, brown sugar, and remaining rice wine. Cover the wok and let liquid come to a boil. Reduce heat to medium-low and simmer, turning the duck every 20 minutes, for 2 hours. Heat oven to 350 degrees F. Remove the cover from the wok and continue cooking the duck on the stove top, basting with the pan juices every 5 minutes, for about 35 to 45 minutes until the juices have evaporated and all that is left is the rendered duck fat. Lift the duck out of the wok, transfer to a roasting pan lined with the cabbage leaves to prevent sticking. Transfer to the oven and cook for 25 to 30 minutes, taking care not to let it burn. Serve hot or at room temperature with the stuffing on the side.
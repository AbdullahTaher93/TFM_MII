Bring a large pot of lightly salted water to a boil. Add pasta and cook for 8 to 10 minutes or until al dente; drain. In a skillet, melt 1/4 cup of the butter. Saute green onions, green peppers, red peppers and mushrooms. Add cream cheese and milk and stir over low heat until cream cheese is melted. Stir in ham and parmesan cheese. Toss spaghetti with remaining butter. Combine with cream cheese mixture; toss lightly.
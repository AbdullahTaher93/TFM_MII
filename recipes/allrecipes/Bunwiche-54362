Preheat the oven to 350 degrees F (175 degrees C). In a small bowl, mix together the butter or margarine, mayonnaise, mustard, onion, and poppy seeds (if using). Season with salt and pepper. Spread a thin layer of the mixture over the cut sides of the buns. Place one slice of cheese on the bottom half of each bun, and top with a few slices of ham. Wrap each sandwich individually with aluminum foil. At this point, the sandwiches could be refrigerated or frozen in a plastic bag. Bake for about 8 minutes in the preheated oven, or until warm all the way through. If sandwiches are frozen, bake for 12 to 15 minutes.
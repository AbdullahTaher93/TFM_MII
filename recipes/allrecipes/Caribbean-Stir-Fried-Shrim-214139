Heat a large skillet or wok over medium-high heat. Add half the oil and heat until smoking, about 10 seconds. Add the onion and stir-fry until lightly browned, about 1 minute. Add the pineapple and stir fry gently until pineapple browns lightly, about 1 minute. Remove pineapple to a bowl and set aside. Add remaining oil to the pan. Add shrimp and stir-fry until opaque, about 1 minute. Add garlic and red pepper, if desired, and stir fry for 10 seconds. Add the tomatoes, chilies, and reserved pineapple and stir fry until heated through, about 1 minute. Stir in soy sauce and serve over rice, if desired.
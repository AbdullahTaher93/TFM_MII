In a saucepan, combine the chicken broth, water, mushrooms, bamboo shoots, ginger, garlic, soy sauce, and hot pepper flakes. Bring to a boil, then reduce the heat to low, cover and simmer while you assemble the rest of the ingredients. Place the chicken slices into a bowl and toss with the sesame oil to coat. In a separate bowl, stir together the cornstarch and vinegar, and set aside. Increase the heat under the broth to medium-high, and return to a rolling boil. Add the chicken slices. Return to a boil, and then drizzle in the egg while stirring slowly to create long strands of egg. Stir in the vinegar and cornstarch. Simmer over medium heat, stirring occasionally, until chicken is cooked through and the broth has thickened slightly, about 3 minutes. Serve garnished with green onions and cilantro.
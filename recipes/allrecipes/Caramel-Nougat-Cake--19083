Preheat oven to 350 degrees F (175 degrees C). Grease and flour a 10 inch tube pan. Sift together the flour and baking soda. Set aside. In a medium saucepan, melt 8 candy bars with 1/2 cup margarine, stirring until smooth. Remove from heat and set aside to cool. In a large bowl, cream together 1/2 cup margarine and 2 cups sugar until light and fluffy. Beat in the eggs one at a time, then stir in the vanilla. Beat in the flour mixture alternately with the buttermilk, mixing just until incorporated. Stir in cooled chocolate mixture and chopped nuts. Pour batter into prepared 10 inch tube pan. Bake in the preheated oven for 40 to 60 minutes, or until a toothpick inserted into the center of the cake comes out clean. Let cool in pan for 15 minutes, then turn out onto a wire rack and cool completely. To make the Frosting: In a medium saucepan melt remaining 3 candy bars with 1/2 cup margarine. Stir until smooth. Beat in confectioners' sugar to desired thickness.
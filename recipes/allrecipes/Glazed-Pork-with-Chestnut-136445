If using frozen chestnuts, fill a large saucepan with water and bring to a boil. Add chestnuts, reduce heat to medium, and simmer until tender, about 25 minutes. Remove from heat, drain, discard liquid, and set aside. (The kind in the jar need no preparation.) Bring a large saucepan of water to a boil. Add bacon and boil for 15 minutes. Transfer bacon to a cutting board, remove rind (if there is any), and slice into 2-inch-by-2-inch pieces. Heat wok over medium heat and add bacon. Stir occasionally, cooking bacon until half of the fat is rendered out and meat is a reddish-brown color, about 30 minutes. Transfer the bacon to a plate and pour off the fat that has accumulated in the wok. Return bacon to wok, add the sugar, and stir well to coat. Stir in the rice wine, soy sauce, and ginger. Cover wok, reduce heat to low, and simmer for about 7 minutes, stirring several times. Add chestnuts and 2 tablespoons of water and cover. Simmer, stirring occasionally, until you can easily insert a fork or chopstick through the meat and the color is deep reddish-brown, about 1 hour. Transfer to a casserole and serve.
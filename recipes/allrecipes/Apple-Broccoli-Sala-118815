In a large bowl, combine the apples, broccoli, onion and raisins. In a small bowl, combine the mayonnaise, vinegar, sugar, lemon juice and salt; pour over apple mixture and toss to coat. Cover and chill for at least 2 hours. Just before serving, stir in the bacon and walnuts.
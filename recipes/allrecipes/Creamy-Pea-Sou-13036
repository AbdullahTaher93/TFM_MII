Place split peas, water, ham bone, shallots, carrots, celery leaves, bay leaf, salt, garlic and pepper into a large pot. Heat to almost boiling. Reduce heat, cover, and simmer for about 1 1/2 hours or until the peas are tender. Remove the ham bone and the bay leaf. Dice the meat from the ham bone and set aside. Cut the cream cheese into cubes. Process cream cheese with the soup in small batches in a blender or food processor. Add ham, and reheat. Taste, and adjust seasonings as necessary.
In a blender or food processor, process cranberries until coarsely ground. Pour into a bowl; add sugar. Cover and chill for 1 hour. Drain pineapple, reserving 1/4 cup of juice (discard remaining juice or save for another use). In a large bowl, combine pineapple, juice and marshmallows. Cover and chill for 1 hour. Add cranberry mixture. In a mixing bowl, beat cream until soft peaks from; beat in sugar and vanilla. Fold into the cranberry-pineapple mixture. Stir in walnuts. Transfer to two greased 8-in. square dishes. Cover and freeze for up to 2 months. Remove from the freezer about 45 minutes before serving. Cut into squares.
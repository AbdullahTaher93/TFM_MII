Preheat oven to 350 degrees F (175 degrees C). Grease a 9x13 inch baking dish. In a large bowl, mix the sweet potatoes and sugar. Stir in the eggs. Mix in milk, vanilla extract, and 1/2 cup melted butter. Gradually stir in the rum until well blended. Transfer the mixture to the prepared baking dish. In a medium bowl, mix the brown sugar, pecans, flour, and 1/3 cup melted butter. Sprinkle this mixture over the mashed sweet potato mixture. Bake 30 minutes in the preheated oven. Allow to sit at least 10 minutes before serving.
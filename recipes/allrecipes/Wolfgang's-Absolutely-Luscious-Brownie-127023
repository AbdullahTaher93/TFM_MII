Position rack in center of oven and preheat oven to 350 degrees. Butter, or coat with vegetable spray, an 8-inch square baking pan. Dust with flour, tapping out excess flour. Set aside. In the top of double boiler or medium heatproof bowl set over simmering water, combine chocolate, butter, and espresso (if desired), stirring occasionally until almost melted. Turn off the heat, stir, and let melt completely. Sift together the flour, baking powder, and salt. Set aside. In a large heatproof mixing bowl set over simmering water, whisk the eggs, sugar, and vanilla until the sugar dissolves. Transfer to the large bowl of an electric mixer, on high speed, using paddle or beaters, beat until pale yellow. Lower speed to medium, scrape in the chocolate mixture, and beat until well mixed. On low speed, gradually add flour mixture and beat just until combined. Add 1 cup of walnuts and again, on low speed, beat just until combined. Scrape into prepared pan and sprinkle remaining walnuts over top of cake. Bake until edges of cake pull away from sides of pan and a toothpick inserted into center of cake comes out clean, 40 to 45 minutes. Cool on wire rack. To serve, cut the brownies into 9 squares, each about 2 1/2 inches. Serve as is or with softly whipped cream or ice cream of your choice.
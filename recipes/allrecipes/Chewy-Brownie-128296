Preheat the oven to 350 degrees F (180 degrees C). Coat an 8 x 8-inch (2-L) baking dish with nonstick spray. Sift the flour, confectioners' sugar, cocoa, and baking powder into a medium bowl. Place the chopped chocolate and margarine in a medium nonstick saucepan. Stir over low heat until the chocolate is just melted and smooth; be very careful not to scorch the chocolate. Remove from the heat. Stir in the brown sugar, corn syrup, water, and vanilla until well blended. Beat the egg whites into the chocolate mixture. Stir in the flour mixture just until well blended and smooth. Transfer the batter to the prepared dish, spreading it evenly. Bake until the top is almost firm when tapped with a finger, 24 to 28 minutes. Transfer the pan to a wire rack and completely cool. Drizzle with the melted chocolate and garnish with the walnut halves, if desired. Cut into squares.
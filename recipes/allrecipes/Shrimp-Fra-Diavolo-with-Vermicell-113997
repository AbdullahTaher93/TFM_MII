In a large frying pan, heat the oil over moderately low heat. Add the onion and cook, stirring occasionally, until translucent, about 5 minutes. Add the garlic and cook, stirring, 30 seconds longer. Stir in the tomatoes, red-pepper flakes, water, parsley, and salt. Reduce the heat and simmer, covered, for 10 minutes. Add the shrimp and cook, covered, just until the shrimp are pink, about 4 minutes. In a large pot of boiling, salted water, cook the vermicelli until just done, about 9 minutes. Drain the pasta and toss with the tomato sauce and shrimp.
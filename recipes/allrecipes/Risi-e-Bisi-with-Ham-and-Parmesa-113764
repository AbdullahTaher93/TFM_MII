In a large pot, melt the butter over moderately low heat. Add the onion, celery, and garlic and cook, stirring occasionally, until the vegetables start to soften, about 5 minutes. Add the wine and boil until it almost evaporates, about 5 minutes. Add the broth and bring to a boil. Boil until the liquid is reduced to approximately 7 cups, about 20 minutes. Add the rice, parsley, and salt and cook at a low boil, stirring occasionally, until the rice is just tender, 10 to 15 minutes. Stir in the peas, ham, Parmesan, and pepper.
Preheat an oven to 375 degrees F (190 degrees C). Grease an 8x8-inch baking dish. Heat the vegetable oil in a skillet over medium heat. Stir in the onion; cook and stir until the onion has softened and turned translucent, about 5 minutes. Reduce heat to medium-low, and continue cooking and stirring until the onion is very tender and dark brown, 15 to 20 minutes more. Set aside. Beat eggs with mayonnaise, flour, salt, and pepper in a large bowl. Stir in broccoli and onion. Pour into the prepared baking dish. Bake in the preheated oven until broccoli is tender, about 90 minutes.
Place the beets and onion into a saucepan over medium heat; add about 1/2 cup of water, bring to a boil, and reduce heat to low. Simmer until the beets are tender, about 15 minutes. Drain the water from the vegetables, and place into the work bowl of a food processor. Add the margarine, start the machine, and pulse several times to finely chop the beets. Whisk together the egg and water until thoroughly mixed, then mix in the flour. Turn the dough out onto a floured surface, and knead until smooth and elastic, 5 to 8 minutes. Divide the dough in half, and form each half into a ball. Roll out a ball until it's 1/8 inch thick or less. Using a cup or cookie cutter, cut out dough circles. Repeat with remaining dough. To fill, place a dough circle into the palm of your hand, and stretch the dough out slightly. Place about 1 tablespoon of the beet filling in the center of the dough, and fold the dough over the filling. Pinch the edges of the dough together to seal completely, and use your index finger to make small crimped indentations all round the sealed edges. Dust the completed pierogi with flour. Fill a large pot with water, and bring to a boil. Drop the pierogies into the water, 1 or 2 at a time, and stir to prevent them from sticking. Reduce heat to a gentle boil, and cook until the pierogies float to the top, about 5 to 8 minutes. Drain and serve.
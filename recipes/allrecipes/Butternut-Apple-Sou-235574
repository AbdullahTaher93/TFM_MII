Heat olive oil in a heavy skillet over medium heat. Cook shallot in hot oil until softened; add apples and saute until hot, about 1 minute. Transfer apple mixture to a stockpot. Pour chicken broth and water into the stockpot; add nutmeg, allspice, cinnamon, and pepper. Bring the mixture to a boil, reduce heat to medium-low, and simmer until the apples are tender, about 15 minutes. Stir butternut squash into the liquid. Bring mixture to a gentle boil while stirring occasionally. Stir half-and-half, butter, and tarragon into the liquid; cook, stirring continually, until the butter melts and the liquid is about to boil, about 5 minutes.
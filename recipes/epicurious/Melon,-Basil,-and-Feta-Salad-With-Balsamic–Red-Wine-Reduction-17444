To make the balsamic reduction, put the balsamic, Marsala and red wine in a heavy-based saucepan over medium-low heat. Cook until reduced by two-thirds and thickened to the consistency of honey (this will take 2 to 3 hours). Remove from the heat and set aside. Put the pistachios and almonds in a small frying pan over medium heat. Cook for 5 minutes, stirring continuously, until lightly brown. Transfer the nuts to a large bowl and allow to cool. Put the lime zest and juice in a small bowl and add the olive oil. Whisk well using a fork or whisk. Put the tomatoes, cantaloupe, and watermelon in a large bowl. Pour over the lime vinaigrette and toss lightly. Arrange the prosciutto or smoked fish (if using) over the top, crumble over the feta, and drizzle with the balsamic reduction. Season with sea salt and freshly ground black pepper and garnish with the toasted nuts and basil leaves.
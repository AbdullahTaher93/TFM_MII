Combine shallots, star anise, if using, chile de árbol, and 3 tablespoons vegetable oil in a large wok or skillet and cook over medium-high heat, stirring often, until shallots are golden, about 5 minutes. Using a slotted spoon, transfer to a paper towel–lined plate; discard star anise and red chile. Season shallots with salt. Increase heat to high; cook shrimp, garlic, and ginger in wok, tossing, until shrimp are cooked through, about 3 minutes. Transfer to another plate. Heat 1 tablespoon vegetable oil in wok; add grains, pressing evenly against bottom and sides of wok. Cook until grains crackle, about 1 minute; toss and press against pan again. Cook until lightly toasted, about 4 minutes. Add shrimp, soy sauce, vinegar, and sesame oil. Cook, tossing, until liquid is absorbed, about 1 minute. Heat remaining 1 tablespoon vegetable oil in a medium nonstick skillet over medium-high heat. Fry eggs until whites are set but yolks are still runny, about 3 minutes. Top grains with eggs, crispy shallots, red chile, and herbs.
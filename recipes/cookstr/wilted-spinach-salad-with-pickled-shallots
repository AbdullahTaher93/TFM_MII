For the Shallots: Combine the vinegar, wine, brown sugar, peppercorns, mustard seeds, chile flakes, and salt in a medium saucepan. Stir over low heat until the sugar has dissolved. Add the shallots and bring to a boil. Reduce to a simmer and cook 5 minutes. Set aside to cool completely in the liquid. Transfer the shallots and all their liquid to a jar or plastic container. Cover tightly and store in the refrigerator up to 2 weeks. For the Salad: In a small bowl, whisk together the vinegar, mustard, salt, pepper, and olive oil. Just before serving, assemble all of the ingredients for the salad on the counter. Turn on a stovetop burner to medium-high. Set a large stainless steel bowl over the burner and heat until very hot. Using an oven mitt or pot holder to protect your hands, pour the vinaigrette into the bowl and swirl for a minute or two, until the vinaigrette is hot. Quickly throw in the spinach and shallots and toss the salad with tongs to coat evenly. When the spinach begins to wilt, remove from the heat and transfer to serving plates. Sprinkle with the toasted pepitas and the cheese if desired. Serve immediately.
Put all the curry paste ingredients into a food processor or blender and blend to a fairly smooth paste, adding a tablespoon of water to help it along if necessary. Heat the oil in a heavy saucepan, then scrape in the curry paste. Fry over medium-low heat for 3 to 4 minutes, stirring often, without letting it color. Add the coconut milk, stock or water, fish sauce, and sugar. Bring to a gentle simmer and cook, uncovered, for 20 to 25 minutes. Meanwhile, cut the green beans into ¾- to 1¼-inch lengths and slice the green onions on the diagonal. Add these to the curry sauce and cook for 5 minutes. Cut the fish fillets into large bite-sized pieces. Add these to the pan, cover with a lid, and simmer gently for 2 to 3 minutes, until the fish is just cooked. Stir in the crabmeat and heat through gently for another minute. Serve in deep bowls, scattered with the cilantro and basil and accompanied by steamed rice.
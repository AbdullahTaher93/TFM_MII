To prepare the soup, preheat the oven to 375°F. Halve the squash lengthwise, scoop out the seeds, and arrange cut side down on a lightly oiled baking sheet. Bake until very tender, 50 to 60 minutes. Cool to room temperature. When cool enough to handle, scrape out the pulp. You should have about 6 cups. Heat the butter in a large soup pot or kettle over medium heat. Add the leeks and cook, stirring often, until softened, about 5 minutes. Add the squash and 1 quart of the chicken stock, increase the heat to high, and bring to a boil. Reduce the heat to medium-high and simmer, stirring often, until the leeks are tender, about 10 minutes. Working in batches, puree the soup in a food processor or blender until smooth. Thin with additional stock as needed to reach the desired consistency. Return to the soup pot and season with salt and pepper. To prepare the pesto, combine the Gruyère, pine nuts, basil, Parmigiano-Reggiano, salt, and pepper in a small bowl. Keep at room temperature until ready to serve. Serve the soup in warmed bowls. Garnish with a spoonful of the pesto just before serving.
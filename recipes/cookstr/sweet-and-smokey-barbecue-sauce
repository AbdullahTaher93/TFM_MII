Combine all the ingredients, except for the ketchup, in a large, deep, heavy, nonreactive saucepan and bring to a simmer over medium heat. Cook, uncovered, until all the ingredients are dissolved, stirring constantly, about 5 minutes. Stir in the ketchup and bring to a boil, stirring well, as the ketchup has a tendency to spatter. Add salt and pepper to taste. Reduce the heat slightly and gently simmer the sauce, uncovered, until dark, thick, and richly flavored, about 30 minutes, stirring often. Use right away or transfer to jars, cover, cool to room temperature, and refrigerate. The sauce will keep for several months.
Soak the onion in a bowl of cold water for 15 minutes. Drain well, then toss with the sour cream, yogurt, lemon juice, and sugar. Stir in the apples and pickles, and season with salt and pepper. Place half the herring in a serving dish and top with the potatoes and beets, if using. Cover with half the sour cream mixture. Layer the remaining herring, potatoes, and beets on top, then spread with the remaining sauce. Cover the dish tightly with plastic wrap and refrigerate for at least 5 hours. Sprinkle with dill just before serving.
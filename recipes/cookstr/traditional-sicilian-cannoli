MAKE THE SHELLS In a food processor, combine the flours, sugar, salt, and cocoa and pulse until blended. Add the butter and pulse until blended. Add the Marsala and pulse to make a soft dough. Turn the dough out onto a lightly floured surface and knead until smooth and elastic. 5 to 7 minutes. Form the dough into a ball, wrap in plastic wrap, and let rest at room temperature for 1 hour. Roll the out dough to a thickness of 1/8 inch. Cut into 4-inch rounds. (If making Cannoli Stacks or Chips. cut the dough into 3-inch rounds.) Keep the dough covered with plastic wrap until ready to wrap and fry. Wrap each dough circle around a cannoli tube that has been lightly sprayed with nonstick cooking spray. Seal the edges with egg white. In a medium saucepan over moderate heat, heat the oil to 350°F. Fry the shells, two or three at a time, until golden brown. Using tongs, carefully remove the tubes from the oil and transfer to paper towels to drain. Let cool. Carefully twist the tubes to remove the shells from the tubes. Let the tubes cool completely before rewrapping with the remaining dough circles. (For Cannoli Stacks or Chips, prick the dough with a fork. Fry two or three at a time, until light brown. Transfer to paper towels to drain.) Let cool before assembling. MAKE THE FILLING In a bowl, combine all of the ingredients and mix well. Place the filling in a pastry bag. Cut off the tip of the pastry bag to make a small opening. Squeeze the filling into both ends of the shells. Sprinkle the ends with additional pistachios and dust with confectioners’ sugar, if desired. Refrigerate until serving.
To make the pesto, in a food processor, combine the basil, pine nuts, and garlic and pulse until well chopped. With the machine running, add the olive oil gradually, stopping to scrape down the sides of the bowl once or twice. Puree until almost smooth; the pesto should have a little texture to it. Transfer the mixture to a bowl and stir in the cheeses. Season generously with salt. Bring a large pot of salted water to a boil over high heat. Add the beans and cook until almost tender, 8 to 10 minutes, depending on their size. Add the pasta and cook until it is al dente. Just before the pasta is ready, whisk a few tablespoons of hot pasta water into the pesto to thin it. Set aside 1 cup of the pasta water, then drain the pasta and beans and return them to the warm pot. Add the pesto and toss well, moistening with some of the reserved pasta water as needed. Divide among warm bowls and serve immediately.
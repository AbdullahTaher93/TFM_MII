Melt the butter in a large frying pan over medium heat. Add the onion and celery and cook about 3 minutes, or until the vegetables begin to soften. Mix the kasha and egg in a bowl. Add to the frying pan and cook, stirring constantly, about 1 minute, or until the grains are dry and separated. Add 2 cups water, the sage, and thyme. Increase the heat to high and bring to a boil. Cover and reduce the heat to medium-low. Simmer for about 12 minutes, or until it is almost tender. Stir in the raisins and walnuts. Continue cooking for about 5 minutes, or until the kasha is tender and all the liquid has been absorbed. Season with salt.
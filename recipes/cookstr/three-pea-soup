Heat the oil in a heavy 3-quart saucepan over medium heat. Add the onion and garlic and saute, stirring constantly, until the onion is golden, about 5 minutes. Add the water and split peas. Bring to a boil, reduce heat to low, and cook 35 to 40 minutes, uncovered, stirring occasionally, until the peas are soft. Measure the mixture and add water, if necessary, to make 4 cups. Beat the half-and-half into the flour with a wire whisk. Beat the mixture into the soup and cook, beating constantly until the soup thickens and the peas break up. Add salt and pepper. Add the fresh green peas; return to a boil over high heat; cook 8 to 10 minutes or until the peas are tender. Stir in the snow peas; if necessary, add water until the soup reaches the desired consistency. Return to a boil; taste and adjust seasoning; serve.
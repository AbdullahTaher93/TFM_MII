Combine the onions, parsley, cilantro, garlic, ginger, and olive oil in a large dish. Add the lamb. Cover and refrigerate for at least 8 hours. Remove the lamb, reserving the marinade. Heat a frying pan over medium-high heat. In batches, add the lamb and cook, turning occasionally, about 5 minutes, until browned. Transfer the lamb to a flameproof casserole. Add the marinade and stock to the casserole and bring to a boil over high heat. Reduce the heat to medium-low and cover. Simmer for 1 hour. Cut the preserved lemons into quarters, discard the flesh, then thinly slice the rinds. Add to the pan and continue simmering for another 30 minutes, or until the lamb is very tender. Season with salt and pepper. Stir in the peas and simmer about 5 minutes, until they are cooked. Sprinkle with lots of chopped parsley and cilantro and serve hot, with lemon wedges.
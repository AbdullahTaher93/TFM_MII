Cook the onions slowly in butter in a small saucepan for 5 minutes or so, until tender and translucent but not browned. Stir in the shallots or onions, and garlic, and cook slowly for 1 minute more. Set aside. Dry the scallops and cut into slices ¼ inch thick. Just before cooking, sprinkle with salt and pepper, roll in flour, and shake off excess flour. Sauté the scallops quickly in very hot butter and oil for 2 minutes to brown them lightly. Pour the wine, or the vermouth and water, into the skillet with the scallops. Add the herbs and the cooked onion mixture. Cover the skillet and simmer for 5 minutes. Then uncover, and if necessary boil down the sauce rapidly for a minute until it is lightly thickened. Correct seasoning, and discard bay leaf. Spoon the scallops and sauce into the shells. Sprinkle with cheese and dot with butter. Set aside or refrigerate until ready to gratine. Just before serving, run under a moderately hot broiler for 3 to 4 minutes to heat through, and to brown the cheese lightly.
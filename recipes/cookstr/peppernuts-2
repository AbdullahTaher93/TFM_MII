Place flour and almonds in food processor and process until nuts are finely ground and powdery. Add candied peels and pulse until peels are finely minced. Pulse in baking powder salt, pepper, and spices. Combine eggs and brown sugar in a large bowl and whisk vigorously until thick and creamy, about 3 minutes. Add about one-third of flour mixture stirring with a wooden spoon. Add remaining flour mixture, stirring just until combined and dough begins to come away from sides of bowl. Scrape dough onto large piece of plastic wrap and form dough into 2 very flat discs, cover completely with wrap, and refrigerate until firm enough to roll into ropes, at least 2 hours or overnight. Line 2 cookie sheets with parchment paper. Take a handful of dough at a time and roll it beneath your palms on a lightly floured surface into a ½-inch-diameter rope. Cut each rope into 1-inch lengths. Place 1 inch apart on cookie sheets. Allow to ripen at room temperature overnight. Preheat oven to 350 degrees F. Bake until light golden brown around edges, about 15 minutes. Slide parchment onto racks. If using just confectioners’ sugar, place it in a bowl and toss warm cookies in to coat, then transfer to rack to cool completely. Alternatively, whisk together confectioners’ sugar, vanilla, and enough hot water in a small bowl to form a very fluid glaze. Dip tops of cookies in glaze, then place glaze side up on racks to cool completely. Ripen cookies at least 1 week by storing in an airtight container along with a slice of apple. Store in small groups of about 2 cups each for every slice of apple so that the moisture provided by the fruit is effective.
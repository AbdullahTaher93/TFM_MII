Wipe the portobello mushroom caps clean with a damp paper towel. Using a small paring knife or teaspoon, remove the gills to create a shallow depression for the stuffing. Place the portobellos on a lightly oiled baking dish and set aside. Position a rack in the center of the oven and preheat the oven to 400°F. Heat the olive oil in a large skillet over medium-low heat. Add the shallots and fennel and cook until soft, 8 to 10 minutes. Add the garlic and shiitake mushrooms and cook until the moisture has evaporated, about 10 minutes. Stir in the spinach and cook until it wilts, about 5 minutes, working in batches, if necessary. Add the parsley, tarragon, and ½ cup of the Parmesan cheese and stir to combine. Cook until the cheese melts, about 1 minute. Season the filling with salt and pepper to taste. Spoon the filling into the portobellos, mounding it slightly. Sprinkle 3 tablespoons of the remaining Parmesan cheese over each mushroom. (The mushrooms can be prepared up to this stage 4 hours ahead. Refrigerate them, covered until ready to bake.) Bake the mushrooms until they are tender but not soggy and the cheese on top has browned, 20 to 25 minutes. Serve immediately.
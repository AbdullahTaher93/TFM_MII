Heat 1 tablespoon of the olive oil in a large skillet over medium-high heat. Add the mushrooms and cook, stirring, until they are lightly browned and have released and reabsorbed their liquid, 4 to 5 minutes. Using a slotted spoon, transfer the mushrooms to a bowl. Wipe out the skillet and add another 2 tablespoons olive oil. Add the onions and cook over medium heat, stirring occasionally, until they are very soft and lightly caramelized, about 15 minutes. If the skillet looks dry as the onions cook, sprinkle in a little water, and adjust the heat so that the onions donâ€™t burn. When the onions are done, add another 3 tablespoons of the oil to the skillet, then add the potatoes. Cook over low heat, stirring very gently, until the ingredients are mixed and the potatoes are infused with the oil, 2 to 3 minutes, adding more oil if the potatoes look dry. Transfer the mixture to the bowl with the reserved mushrooms and gently stir to combine. Season with salt and pepper to taste and let cool completely. (The potato mixture can be prepared up t this stage a few hours in advance.) Place the eggs, chicken stock, and a few pinches of salt in a large mixing bowl and beat until the eggs are just scrambled. Add the potato mixture and the truffle oil and mix until well combined. Let stand for about 10 minutes. Heat about 5 teaspoons of the remaining olive oil in a heavy 8-inch skillet, preferably nonstick, over medium-high heat until it is just beginning to smoke. Pour the egg mixture into the skillet and flatten it with a spatula until the top is fairly even. Reduce the heat to medium-low. Cook, moving and shaking the skillet, running a thin spatula around the edge and sliding it into the middle so that some of the egg runs under. Cook the tortilla in this fashion until the top is a little wet but not liquid, about 6 minutes. Run the spatula under the tortilla to make sure that no part of the bottom is stuck to the skillet. Top the skillet with a rimless plate slightly larger than the skillet and, using oven mitts, quickly invert the tortilla onto the plate. If the skillet looks dry, add a little more olive oil. Carefully slide the tortilla back into the skillet, uncooked side down. Shake the skillet to straighten the tortilla and push the edges in with the spatula. Reduce the heat to very low and cook the tortilla until a toothpick inserted in the center comes out dry, 3 to 4 minutes. Invert the tortilla again, as before, and cook on the first side for another minute. Invert the tortilla onto a serving plate and pat the top with a paper towel to get rid of excess oil. Let cool a little, then cut the tortilla into wedges and serve warm or at room temperature. To serve as a tapa, cut the tortilla into squares and serve with toothpicks.
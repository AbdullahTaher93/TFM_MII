Sprinkle the chicken with 1 tbsp of the flour and season with salt and pepper. Melt 2 tbsp of the butter in a large flameproof casserole over medium heat. In batches, add the chicken and cook about 6 minutes, turning, until golden brown on all sides. Transfer to a plate. Add the pancetta, carrot, celery, and garlic and cook about 5 minutes, until softened. Sprinkle in the remaining flour, stir well, and cook for 1 minute. Add the wine and brandy and bring to a boil, stirring up the browned bits in the pan. Return the chicken to the pan and add the thyme and bay leaf. Cover, reduce the heat to medium-low, and simmer about 30 minutes. Meanwhile, melt the remaining butter with the oil in a frying pan over medium heat. Add the onions and cook about 6 minutes, until lightly browned. Stir in the sugar, vinegar, and 1 tbsp water. Add the onions and mushrooms to the chicken. Cook until the chicken is cooked through, about another 15 minutes. Transfer the chicken and vegetables to a deep platter and keep warm. Discard the thyme and bay leaf. Skim off the fat from the surface of the sauce. Bring to a boil over high heat and cook for about 5 minutes, until the sauce thickens. Season with salt and pepper. Pour over the chicken and serve hot.
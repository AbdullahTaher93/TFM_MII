Trim off excess fat, and cut the ham into serving pieces. Dry on paper towels. A few pieces at a time, brown the ham lightly for a minute on each side in hot butter and oil. Set the ham aside. Pour all but 2Â½ tablespoons of fat out of the skillet. Stir in the flour with a wooden spoon, then the shallots or onions, and cook slowly for 2 or 3 minutes without browning. Remove from heat. Bring the stock or bouillon and wine to the simmer in a small saucepan. Blend it into the flour in the skillet with a wire whip. Beat in the tomato paste and pepper. Bring the sauce to a simmer, stirring, then beat in the cream. Simmer for 4 or 5 minutes, allowing the sauce to reduce until it coats the spoon lightly. Taste carefully for seasoning but do not over salt. Stir in the cognac. Then add the ham slices and spoon the sauce over them. (May be done in advance to this point. Film surface with a spoonful of cream and set aside.) Shortly before serving, bring to the simmer, cover, and simmer slowly for a minute or two until the ham is tender when pierced with a fork. Taste again for seasoning. Transfer the ham to a platter, or place it over a bed of braised spinach. Spoon the sauce over the ham and serve.
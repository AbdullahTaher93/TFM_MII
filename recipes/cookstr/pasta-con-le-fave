Have ready a bowl of ice water. Shell the fava beans. Bring a large pot of water to a boil over high heat. Add the shelled beans and blanch for 30 seconds to 1 minute, depending on their size, then drain and transfer them to the ice water. When cool, drain again. Peel the beans; the skins should slip off easily. You should have 1½ to 2 cups. Heat the olive oil in a large skillet over moderately low heat. Add the onion, garlic, hot pepper flakes, and mint sprigs and cook until the onion is soft, about 10 minutes. Add the fava beans, a generous pinch of salt, and enough water to cover the beans completely (1½ to 2 cups). Bring to a simmer, cover partially, and simmer gently until the beans are tender, about 15 minutes. The liquid should be nicely flavored and somewhat reduced but still brothy. Add a little water as the beans cook as needed. Remove the garlic and the mint sprigs. Bring a large pot of salted water to a boil over high heat. Add the pasta and cook until about 1 minute shy of al dente. Set aside 1 cup of the pasta water, then drain the pasta and return it to the warm pot over moderately low heat. Add the sauce and cook for about 1 minute to allow the pasta to absorb some of the flavor of the sauce. Moisten with some of the reserved pasta water as needed. Grate the cheese into the pasta and toss again, then divide the pasta among warm bowls and serve immediately.
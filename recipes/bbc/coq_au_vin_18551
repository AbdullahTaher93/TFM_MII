Pour the wine into a saucepan and boil over a high heat until the volume has reduced by half. Set aside.Meanwhile, heat the oil in a lidded casserole dish. Add the chicken joints and fry over a high heat until golden-brown all over. Remove from the pan and set aside.Add the bacon and fry until the fat is rendered, then remove from the pan and set aside. Add the mushrooms and fry until cooked, then remove from the pan and set aside.Add the shallots and celery to the pan and fry over a high heat for few minutes (adding a little more oil, if needed).Sprinkle in the flour and stir for 1 minute. Gradually add the reduced wine and stock and stir until combined. Bring to the boil, return the chicken to the pan, add the thyme and season with salt and pepper.Lower the heat and simmer for 30 minutes, with the lid on.Return the bacon and mushrooms to the pan and simmer for 15 minutes, or until the chicken is tender and cooked through.Remove the thyme sprigs and serve.
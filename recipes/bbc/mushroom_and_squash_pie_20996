Heat 2 tablespoons oil in a large non-stick frying pan and fry the mushrooms over a medium–high heat for 4–5 minutes, or until lightly browned. Tip onto a plate and return the pan to the heat.Add the remaining tablespoon of oil and reduce the heat. Gently fry the onion and squash for 5 minutes, or until the onion is lightly browned and the squash is beginning to soften, stirring regularly.Add the kale, stir in the stock and bring to a simmer. Simmer for 3 minutes, or until the liquid is reduced to almost nothing, stirring regularly.Stir in the apricots and gently heat for 2 minutes. Remove from the heat and add the chestnuts, walnuts and reserved mushrooms, stirring well. Add the chilli flakes, if using. Season with salt and pepper. Leave to cool for 45–60 minutes.Preheat the oven to 190C/170C Fan/Gas 5. Line a baking tray with baking paper. Place one sheet of the filo pastry across the tray and brush with a little oil. Add a second sheet of pastry at right-angles to the first to make a cross shape. Brush with a little more oil. Place the third sheet diagonally over the first and brush with a little more oil. Add the fourth sheet diagonally in the opposite direction.Spoon the filling into the centre of the pastry and flatten into a circle around 20cm/8in wide and 4cm/1½in deep. Scatter with the goats’ cheese.Bring the excess pastry up around the filling, leaving a gap at the top, scrunching loosely. Brush the pastry with the rest of the oil. Bake for 25–30 minutes. Serve in slices, garnished with parsley if liked.
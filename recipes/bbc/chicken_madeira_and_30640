For the casserole, season the chicken pieces with salt and freshly ground black pepper, then dredge them in the flour to coat.Heat two-thirds of the butter in a frying pan over a medium heat. When foaming, add the chicken pieces, in batches if necessary, and fry for 2-3 minutes, or until golden-brown on each side. (Do not overcrowd the pan.) Remove the chicken pieces from the pan and transfer to a casserole or a large heavy-based saucepan.Place the casserole over a medium heat. Add the onion, garlic, Madeira, chicken stock, cream and thyme, stir well and bring the mixture to the boil. Reduce the heat until the mixture is simmering, then simmer for 12-15 minutes.Stir in the mushrooms and continue to simmer for a further 12-15 minutes, or until the chicken pieces are cooked through and the sauce has thickened slightly. (The chicken is cooked through when the juices run clear when pierced in the thickest part with a knife, and no trace of pink remains.) Season, to taste, with salt and freshly ground black pepper, then stir in the remaining butter and the parsley.Meanwhile, for the mash, boil the potatoes in a pan of salted water, then reduce the heat and simmer for 12-15 minutes, or until tender. Drain well and return to the pan, then place over a low heat for a couple of minutes to dry them slightly.Mash or rice the potatoes until smooth, then stir in the butter and cream until smooth and well combined, and season to taste.Serve the casserole with a spoonful of mash.
For the curry, heat the oil in a large frying pan. Add the onion, turmeric, peppercorns, fenugreek, cinnamon stick, 9 curry leaves, chillies, coriander and chilli powder and sweat for 2–3 minutes. Stir in the tamarind paste and coconut milk. Simmer for 10 minutes, then add the cod and gently poach for 8–10 minutes.Preheat a deep-fat fryer to 180C/350F. (CAUTION: do not leave unattended. Hot oil can be dangerous.) Place the flour and chilli powder in a small bowl, season with salt and pepper and mix together. Mix the egg and milk together in a separate bowl with a tablespoon of water.Dip the crab halves in the flour mixture and then in the egg mixture. Place in the deep-fat fryer for 3–4 minutes, turning two or three times, or until golden brown and crispy. Carefully remove the crabs from the hot oil using a slotted spoon, place on a plate lined with kitchen paper and season with salt and pepper.For the samosas, heat the oil in a frying pan and add the cauliflower, onion, apple, beans, turmeric, ginger, garlic, coriander seeds and cumin seeds. Cook for 10 minutes, or until the vegetables are soft, and stir in the flour and mustard powder. Stir in the vinegar and a few teaspoons of water to make a paste. Season with salt and pepper and cook for a further 5 minutes. Remove from the heat and leave to cool.Preheat the deep-fat fryer again to 180C/350F. Lay out the spring roll wrappers, add the filling evenly to the centre of each wrapper and then fold into a triangle. Place each samosa in the deep fat fryer for 5–8 minutes, then carefully remove using a slotted spoon onto a plate lined with kitchen paper.For the pickles, toss the onion and cucumber in the sugar and salt and leave to drain in a colander for 10 minutes. Squeeze to remove any excess water and toss in the lime juice. Set aside.Just before serving, add the crab halves to the curry and spoon into four warmed bowls. Garnish with the curry leaves and coriander and serve with the lime wedges, samosas and pickles alongside.
To make the pastry, pulse the flours, salt, sugar, hazelnuts and butter together in a food processor. Add the egg with a tablespoon of water and bring together to form a rough dough. Cover and chill in the fridge for 30 minutes.Meanwhile, toss the peaches in the sugar. Heat the olive oil in a frying pan and cook the peaches for 15–20 minutes, until they are a deep golden colour. Add the Muscat and cook for 5 minutes or so, until the peaches have caramelised.Add the lemon juice and cook for a further minute then remove from the heat and leave the peaches to cool in their juices.Lightly dust a work surface with flour and roll out the pastry between two sheets of baking paper. Line a 24cm/9½in tart tin with the pastry, leaving the edges to overhang, and put in the freezer for 10 minutes.Preheat the oven to 200C/180C Fan/Gas 6. Make the filling by blending together the butter, ground hazelnuts, icing sugar, salt and lemon zest in the food processor.  (You may need to scrape the mixture down the sides and pulse again.) Add the eggs, Muscat and plain flour, and blend until combined.Remove the pastry from the freezer and arrange the peaches in their juices in the bottom of the tart. Top with the filling and smooth off the top with a palette knife. Scatter over hazelnut halves and the ruby chocolate. Pinch the pastry around the filling, leaving the top open.Bake the crostata for 20–25 minutes. Reduce the temperature to 180C/160C Fan/Gas 4 and bake for a further 15–20 minutes, until the filling is firm to the touch, and the pastry is deeply golden. Serve warm or cold, with clotted cream or ice cream.
Put the shallots in a large bowl with the garlic, herbs and wine. Mix, then add the chicken breasts, season with salt and black pepper and marinate for at least 1 hour. When you’re ready to cook, preheat the oven to 160C/140C Fan/Gas 3.Sit a colander over a large saucepan and strain the marinated chicken, reserving the shallots, bay leaves and thyme. Dab the chicken with kitchen paper to dry it.Heat the oil and 50g/1¾oz of the butter in a deep ovenproof frying pan or casserole dish. Add the chicken breasts and fry on a medium-high heat, for 5–10 minutes each side, or until browned all over – you may need to do this in batches. Remove with a slotted spoon and set aside.Meanwhile, set the pan with the wine marinade over a high heat and boil, for 5–10 minutes, until the volume of liquid has reduced by a third. Add the flour to a bowl with 150ml/5fl oz water and whisk until smooth. Stir in a little of the hot wine, and add this mixture to the rest of the wine in the pan. Keep hot.Add the bacon to the frying pan or casserole dish and fry over a high heat for about 10 minutes, or until browned. Add the reserved shallots and continue to cook for another 10 minutes, or until they start to soften.Add the hot wine sauce and tomato purée to the frying pan or casserole dish with the sugar, reserved bay leaves, thyme, salt and black pepper and bring to a boil. Stir until thickened and add the browned chicken. Bring back to the boil, cover with a lid and bake for 20–25 minutes, or until cooked through.Meanwhile, melt the remaining butter in a medium pan and fry the mushrooms over a medium heat for 5–10 minutes, or until just cooked. Add to the chicken casserole just before serving. Remove the bay leaves and thyme from the casserole and serve the casserole hot with mashed potato and shredded cabbage.